# SAP - Solar Activity Prediction

Проект для предсказания солнечных пятен с использованием модели NARX (Nonlinear AutoRegressive with eXogenous inputs).

## Описание

Этот проект использует нейронную сеть NARX для предсказания солнечных пятен на 18 месяцев вперед. Модель обучена на исторических данных о солнечных пятнах и теоретических значениях солнечной активности.

## Структура проекта

```
SAP/
├── data/
│   ├── model_weights/          # Веса обученных моделей для разных горизонтов
│   └── theoretical_series.csv  # Теоретические данные солнечной активности
├── scripts/
│   ├── data_x18.py            # Класс для подготовки данных
│   └── model_x18.py           # Архитектура модели NARX
├── predict.py                 # Основной скрипт для предсказаний
├── requirements.txt           # Зависимости проекта
└── README.md                  # Документация проекта
```

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd SAP
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

### Базовое использование

```bash
python predict.py
```

### Расширенные параметры

```bash
python predict.py --depth 6 --need_plot --device cuda --path_to_save results
```

### Параметры командной строки

- `--path_to_save` - Директория для сохранения предсказаний (по умолчанию: `predictions`)
- `--depth` - Глубина предсказания - количество последних месяцев для анализа (по умолчанию: 4). Если сейчас октябрь и `depth=4`, то будут предсказаны значения, соответствующие октябрю, сентябрю, августу и июлю. Горизонт предсказания в 18 месяцев и `depth` отвечают за разное!
- `--device` - Устройство для вычислений: `cpu`, `cuda`, или `mps` (по умолчанию: автоопределение)
- `--need_plot` - Создать график с предсказаниями

## Архитектура модели

Модель NARX использует:
- **Входные данные**: Теоретические значения солнечной активности и исторические данные о солнечных пятнах
- **Архитектура**: Полносвязная нейронная сеть с сигмоидными активациями и Softplus на выходе
- **Горизонт предсказания**: 18 месяцев вперед
- **Нормализация**: Данные нормализуются по максимальному значению наблюдаемого ряда

## Требования к системе

- Python 3.8+
- PyTorch 1.12+
- CUDA (опционально, для ускорения на GPU)
- macOS Metal Performance Shaders (MPS) поддержка для Apple Silicon

## Данные

Проект использует данные из:
- [SILSO (Sunspot Index and Long-term Solar Observations)](https://www.sidc.be/SILSO/)
- Теоретические данные солнечной активности из локального файла
